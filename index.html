<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gmail টুলস: নাম, জেনারেটর, এক্সট্রাক্টর, এবং ডুপ্লিকেট ডিটেক্টর</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Neue', 'Noto Sans Bengali', sans-serif;
        }

        body {
            min-height: 100vh;
            background: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect x="0" y="0" width="100" height="100" fill="%23ffeb3b"/%3E%3Ccircle cx="20" cy="20" r="10" fill="%23f44336" opacity="0.3"/%3E%3Ccircle cx="80" cy="30" r="15" fill="%232196f3" opacity="0.3"/%3E%3Ccircle cx="50" cy="70" r="12" fill="%234caf50" opacity="0.3"/%3E%3C/svg%3E');
            color: #333;
            padding: 16px;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            padding: 24px;
            border-radius: 20px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(255, 235, 59, 0.5);
            max-width: 700px;
            margin: 20px auto;
            border: 5px solid #f44336;
            animation: bounceIn 0.5s ease-out;
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.8); }
            60% { opacity: 1; transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        h1 {
            font-size: 32px;
            font-weight: 700;
            color: #d81b60;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        h2 {
            font-size: 24px;
            color: #ff6f61;
            margin-bottom: 15px;
            text-align: center;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            background: #d81b60;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: #b21750;
            transform: scale(1.05);
        }

        .tab-btn.active {
            background: #f44336;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .input-box {
            margin: 12px 0;
            position: relative;
        }

        input, textarea {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 3px solid #333;
            border-radius: 15px;
            background: #fff;
            color: #333;
            outline: none;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus {
            border: 3px solid #f44336;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
            transform: scale(1.02);
        }

        textarea {
            height: 160px;
            resize: vertical;
            background-color: #f9fafb;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin: 16px 0;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 700;
            border: 3px solid #333;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        }

        button:active {
            transform: scale(0.95);
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }

        .generate-btn, .process-btn, .check-gmail-btn {
            background: #f44336;
            color: #fff;
        }

        .generate-btn:hover, .process-btn:hover, .check-gmail-btn:hover {
            background: #d32f2f;
        }

        .create-account-btn {
            background: #4caf50;
            color: #fff;
        }

        .create-account-btn:hover {
            background: #388e3c;
        }

        .copy-all-btn, .copy-unique-btn, .copy-duplicate-btn {
            background: #2196f3;
            color: #fff;
        }

        .copy-all-btn:hover, .copy-unique-btn:hover, .copy-duplicate-btn:hover {
            background: #1976d2;
        }

        .delete-all-btn, .delete-btn {
            background: #ff9800;
            color: #fff;
        }

        .delete-all-btn:hover, .delete-btn:hover {
            background: #f57c00;
        }

        .copy-btn {
            background: #9c27b0;
            color: #fff;
            padding: 6px 12px;
            font-size: 14px;
            margin-left: 8px;
            border: 2px solid #333;
            border-radius: 10px;
        }

        .copy-btn:hover {
            background: #7b1fa2;
            transform: scale(1.05);
        }

        .table-container {
            margin-top: 16px;
            max-height: 350px;
            overflow-y: auto;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.7);
            border: 3px solid #333;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 15px;
        }

        th, td {
            padding: 10px;
            text-align: center;
            border: 2px solid #333;
            white-space: nowrap;
        }

        th {
            background: #f44336;
            color: #fff;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        td {
            background: #ffeb3b;
        }

        tr:nth-child(even) td {
            background: #ffcc80;
        }

        tr:hover td {
            background: #f06292;
        }

        .action-btn {
            padding: 8px;
            font-size: 14px;
            border: 2px solid #333;
            border-radius: 10px;
            cursor: pointer;
            width: 60px;
            height: 36px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            margin: 0 4px;
        }

        .success-btn {
            background: #4caf50;
            color: #fff;
        }

        .success-btn:hover {
            background: #388e3c;
        }

        .timestamp {
            font-size: 12px;
            color: #333;
            display: block;
            margin-top: 4px;
        }

        .error {
            color: #d32f2f;
            margin-top: 10px;
            display: none;
            text-align: center;
        }

        .note, .support {
            font-size: 14px;
            color: #333;
            margin-top: 16px;
            text-align: center;
        }

        .support a {
            color: #d81b60;
            text-decoration: none;
        }

        .support a:hover {
            text-decoration: underline;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.9);
            padding: 24px;
            border-radius: 20px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            border: 5px solid #f44336;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }

        .modal-content h2 {
            font-size: 22px;
            color: #d81b60;
            margin-bottom: 16px;
        }

        .modal-content p {
            font-size: 16px;
            margin-bottom: 16px;
        }

        .modal-content button {
            margin: 8px;
        }

        .locked {
            pointer-events: none;
            opacity: 0.5;
        }

        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        li {
            padding: 15px;
            background-color: #f9fafb;
            margin: 8px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 16px;
            border: 1px solid #e5e7eb;
        }

        .duplicate {
            background-color: #fee2e2;
            border-left: 5px solid #ef4444;
        }

        .email-info {
            font-size: 16px;
            color: #1e3a8a;
            font-weight: 600;
        }

        #message, #duplicateCount, #totalEmails {
            margin: 12px 0;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
        }

        #message {
            color: #ef4444;
        }

        #duplicateCount {
            color: #1e3a8a;
        }

        #totalEmails {
            color: #3b82f6;
        }

        #output {
            background-color: #e1f5fe;
            color: #333;
            min-height: 120px;
            white-space: pre-wrap;
        }

        #count {
            margin-top: 10px;
            font-weight: bold;
            color: #33691e;
            text-align: center;
        }

        .subscription-info {
            margin: 20px 0;
            font-size: 16px;
            line-height: 1.6;
        }

        .subscription-info a {
            color: #d81b60;
            text-decoration: none;
        }

        .subscription-info a:hover {
            text-decoration: underline;
        }

        .notice {
            background: #ffeb3b;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
            color: #d32f2f;
            font-weight: 700;
            border: 2px solid #d32f2f;
        }

        .version-bar {
            background: #4caf50;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 16px;
            color: #fff;
            font-weight: 700;
            border: 2px solid #388e3c;
        }

        .version-bar.free {
            background: #2196f3;
            border: 2px solid #1976d2;
        }

        @media (max-width: 480px) {
            .container {
                padding: 16px;
            }

            h1 {
                font-size: 28px;
            }

            h2 {
                font-size: 20px;
            }

            input, textarea, button {
                font-size: 14px;
                padding: 10px;
            }

            .tabs {
                flex-direction: column;
                gap: 8px;
            }

            .tab-btn {
                font-size: 14px;
                padding: 8px 16px;
            }

            .button-group {
                flex-direction: column;
                gap: 8px;
            }

            table {
                font-size: 13px;
            }

            th, td {
                padding: 6px;
            }

            .copy-btn, .action-btn {
                padding: 4px 8px;
                font-size: 12px;
            }

            .modal-content {
                padding: 16px;
            }

            .modal-content h2 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <div class="version-bar free" id="versionBar">Free Version (সাবস্ক্রিপশন প্রয়োজন)</div>
        <div class="notice">
            <i class="fas fa-exclamation-triangle"></i> নোটিস: ব্রাউজার ডাটা ক্লিয়ার অথবা কুকিজ ডিলিট করলে এখানে থাকা তথ্য ডিলিট হয়ে যাবে।
        </div>
        <div class="button-group">
            <button class="check-gmail-btn" onclick="window.open('https://en.gmailcheck.com/', '_blank')"><i class="fas fa-envelope"></i> জিমেইল চেক করুন</button>
        </div>
        <h1><i class="fas fa-envelope"></i> Gmail টুলস</h1>
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('nameGenerator')">নাম জেনারেটর</button>
            <button class="tab-btn" onclick="showTab('gmailGenerator')">জিমেইল জেনারেটর</button>
            <button class="tab-btn" onclick="showTab('gmailExtractor')">জিমেইল এক্সট্রাক্টর</button>
            <button class="tab-btn" onclick="showTab('duplicateDetector')">ডুপ্লিকেট ডিটেক্টর</button>
            <button class="tab-btn" onclick="showTab('videoGuide')">ভিডিও গাইড</button>
        </div>

        <!-- Name Generator Tab -->
        <div class="tab-content active" id="nameGenerator">
            <h2>নাম জেনারেটর</h2>
            <div class="button-group">
                <button class="generate-btn" onclick="generateName()"><i class="fas fa-sync"></i> নাম জেনারেট</button>
                <button class="copy-all-btn" onclick="copyAllNames()"><i class="fas fa-copy"></i> সব কপি</button>
                <button class="delete-all-btn" onclick="deleteAllNames()"><i class="fas fa-trash"></i> সব ডিলিট</button>
            </div>
            <div class="table-container">
                <table id="nameTable">
                    <thead>
                        <tr>
                            <th>নাম</th>
                            <th>অ্যাকশন</th>
                        </tr>
                    </thead>
                    <tbody id="nameTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Gmail Generator Tab -->
        <div class="tab-content" id="gmailGenerator">
            <h2>জিমেইল জেনারেটর</h2>
            <p>বৈধ জিমেইল আইডি এবং পাসওয়ার্ড তৈরি করুন</p>
            <div class="input-box">
                <input type="text" id="generatedEmail" placeholder="ইমেইল আইডি" readonly>
            </div>
            <div class="input-box">
                <input type="text" id="generatedPassword" placeholder="পাসওয়ার্ড" readonly>
            </div>
            <div class="button-group">
                <button class="generate-btn" onclick="generateCredentials()"><i class="fas fa-sync"></i> জেনারেট</button>
                <button class="create-account-btn" onclick="createAccountFromInput()"><i class="fas fa-user-plus"></i> একাউন্ট তৈরি</button>
                <button class="copy-all-btn" onclick="copyAllCredentials()"><i class="fas fa-copy"></i> সব কপি</button>
                <button class="delete-all-btn" onclick="deleteAllCredentials()"><i class="fas fa-trash"></i> সব ডিলিট</button>
            </div>
            <div class="table-container">
                <table id="credentialsTable">
                    <thead>
                        <tr>
                            <th>ইমেইল</th>
                            <th>পাসওয়ার্ড</th>
                            <th>অ্যাকশন</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
            <div class="note">
                <p><i class="fas fa-info-circle"></i> নোট: জেনারেট করা ইমেইল এবং পাসওয়ার্ড কপি করা যাবে। "একাউন্ট তৈরি" দিয়ে জিমেইল অ্যাকাউন্ট তৈরি করুন।</p>
            </div>
        </div>

        <!-- Gmail Extractor Tab -->
        <div class="tab-content" id="gmailExtractor">
            <h2>Gmail আলাদা করার টুল</h2>
            <textarea id="inputText" rows="8" placeholder="এখানে যেকোনো লেখা পেস্ট করো..."></textarea>
            <div class="button-group">
                <button class="generate-btn" onclick="extractGmails()"><i class="fas fa-filter"></i> Gmail আলাদা করো!</button>
                <button class="copy-all-btn" onclick="copyGmails()"><i class="fas fa-copy"></i> Gmail কপি করো</button>
            </div>
            <textarea id="output" rows="6" readonly></textarea>
            <div id="count">মোট Gmail: ০ টি</div>
        </div>

        <!-- Gmail Duplicate Detector Tab -->
        <div class="tab-content" id="duplicateDetector">
            <h2>জিমেইল ডুপ্লিকেট ডিটেক্টর</h2>
            <textarea id="inputData" placeholder="জিমেইল পেস্ট করুন (যেমন: example@gmail.com)"></textarea>
            <div class="button-group">
                <button class="process-btn" onclick="processEmails()"><i class="fas fa-cog"></i> প্রসেস করুন</button>
                <button class="copy-unique-btn" onclick="copyUniqueEmails()"><i class="fas fa-copy"></i> ইউনিক কপি</button>
                <button class="copy-duplicate-btn" onclick="copyDuplicateEmails()"><i class="fas fa-copy"></i> ডুপ্লিকেট কপি</button>
            </div>
            <div id="message"></div>
            <div id="duplicateCount"></div>
            <div id="totalEmails"></div>
            <ul id="emailList"></ul>
        </div>

        <!-- Video Guide Tab -->
        <div class="tab-content" id="videoGuide">
            <h2>কীভাবে কাজ করবেন</h2>
            <p>নিচের ভিডিও গাইড দেখুন কীভাবে এই টুলগুলো ব্যবহার করবেন:</p>
            <div class="subscription-info">
                <p><a href="https://www.youtube.com" target="_blank">ভিডিও লিঙ্ক (পরে আপডেট করুন)</a></p>
            </div>
        </div>

        <div class="support">
            <p><i class="fas fa-headset"></i> সাপোর্ট: <a href="https://wa.me/+8801775792780" target="_blank">হোয়াটসঅ্যাপ (+8801775792780)</a></p>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div class="modal" id="subscriptionModal">
        <div class="modal-content">
            <h2><i class="fas fa-lock"></i> সাবস্ক্রিপশন প্রয়োজন</h2>
            <p>৩০ দিনের সাবস্ক্রিপশন কিনুন:</p>
            <p>১. ৩০ টাকা বিকাশে পাঠান: <strong>01775792780</strong> (পার্সোনাল)</p>
            <p>২. হোয়াটসঅ্যাপ নাম্বারে স্ক্রিনশট পাঠান এবং কোড সংগ্রহ করুন: <a href="https://wa.me/+8801775792780" target="_blank">+8801775792780</a></p>
            <p>৩. অ্যাক্টিভেশন কোড লিখুন:</p>
            <input type="text" id="activationCode" placeholder="অ্যাক্টিভেশন কোড লিখুন">
            <div class="button-group">
                <button class="generate-btn" onclick="activateSubscription()"><i class="fas fa-check"></i> অ্যাক্টিভেট</button>
                <button class="delete-btn" onclick="closeSubscriptionModal()"><i class="fas fa-times"></i> বন্ধ করুন</button>
            </div>
            <p id="subscriptionError" class="error"></p>
        </div>
    </div>

    <script>
        // Subscription Logic
        const VALID_CODE = 'y9'; // সাবস্ক্রিপশন কোড
        const SUBSCRIPTION_DAYS = 30;

        function checkSubscription() {
            const subscriptionData = JSON.parse(localStorage.getItem('subscription') || '{}');
            const { isPaid, expiry } = subscriptionData;
            const now = new Date();
            const versionBar = document.getElementById('versionBar');

            if (isPaid && expiry && new Date(expiry) > now) {
                // পেইড সাবস্ক্রিপশন সক্রিয়
                document.getElementById('mainContainer').classList.remove('locked');
                document.getElementById('subscriptionModal').style.display = 'none';
                versionBar.textContent = 'Paid Version';
                versionBar.classList.remove('free');
            } else {
                // সাবস্ক্রিপশন প্রয়োজন
                document.getElementById('mainContainer').classList.add('locked');
                document.getElementById('subscriptionModal').style.display = 'flex';
                versionBar.textContent = 'Free Version (সাবস্ক্রিপশন প্রয়োজন)';
                versionBar.classList.add('free');
            }
        }

        function activateSubscription() {
            const inputCode = document.getElementById('activationCode').value.trim();
            const errorDiv = document.getElementById('subscriptionError');
            const usedCodes = JSON.parse(localStorage.getItem('usedCodes') || '[]');

            if (!inputCode) {
                errorDiv.textContent = 'দয়া করে অ্যাক্টিভেশন কোড লিখুন।';
                errorDiv.style.display = 'block';
                return;
            }

            if (usedCodes.includes(inputCode)) {
                errorDiv.textContent = 'এই সাবস্ক্রিপশন কোডটি ইতিমধ্যে ব্যবহৃত হয়েছে।';
                errorDiv.style.display = 'block';
                return;
            }

            if (inputCode === VALID_CODE) {
                const now = new Date();
                const expiry = new Date(now.getTime() + SUBSCRIPTION_DAYS * 24 * 60 * 60 * 1000);
                const subscriptionData = { isPaid: true, expiry: expiry.toISOString() };
                localStorage.setItem('subscription', JSON.stringify(subscriptionData));
                usedCodes.push(inputCode);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('সাবস্ক্রিপশন সফলভাবে অ্যাক্টিভেট হয়েছে!');
                checkSubscription();
            } else {
                errorDiv.textContent = 'ভুল কোড! দয়া করে সঠিক কোড লিখুন।';
                errorDiv.style.display = 'block';
            }
        }

        function closeSubscriptionModal() {
            document.getElementById('subscriptionModal').style.display = 'none';
            document.getElementById('mainContainer').classList.add('locked');
        }

        // Tab Navigation
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        // Name Generator Logic
        const firstNames = [
            'Pinak', 'Clyde', 'Cristal', 'Tia', 'Jimmie', 'Tom', 'Emma', 'Liam', 'Olivia', 'Noah',
            'Ava', 'Sophia', 'James', 'Isabella', 'William', 'Mia', 'Alexander', 'Charlotte', 'Henry', 
            'Amelia', 'Harper', 'Evelyn', 'Lucas', 'Abigail', 'Benjamin', 'Emily', 'Elijah', 'Ella', 
            'Daniel', 'Avery', 'Logan', 'Sofia', 'Jackson', 'Madison', 'Sebastian', 'Scarlett', 'Jack', 
            'Chloe', 'Aiden', 'Lily', 'Samuel', 'Grace', 'Ethan', 'Aria', 'Oliver', 'Mila', 'Jacob', 
            'Luna', 'Michael', 'Penelope', 'Mason'
        ];

        const prefixes = ['Mr', 'Ms', 'Miss', 'Dr', 'Prof'];
        const usedNames = new Set();
        let nameCounter = 0;

        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateName() {
            const nameTableBody = document.getElementById('nameTableBody');

            if (usedNames.size >= 1000000) {
                alert('সর্বোচ্চ ইউনিক নাম তৈরি হয়েছে। নাম পুল রিসেট করা হচ্ছে।');
                usedNames.clear();
                nameCounter = 0;
            }

            let name;
            let attempts = 0;
            const maxAttempts = 1000;

            do {
                const prefix = getRandomItem(prefixes);
                const firstName = getRandomItem(firstNames);
                const uniqueSuffix = nameCounter > 0 ? `.${nameCounter}` : '';
                name = `${prefix}${firstName}${uniqueSuffix}`.replace(/\s/g, '');

                attempts++;
                if (attempts > maxAttempts) {
                    name = `${prefix}${firstName}.${nameCounter}`.replace(/\s/g, '');
                    nameCounter++;
                    break;
                }
            } while (usedNames.has(name));

            usedNames.add(name);

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${name}</td>
                <td>
                    <button class="copy-btn" onclick="copyText('${name}')"><i class="fas fa-copy"></i> কপি</button>
                    <button class="action-btn delete-btn" onclick="deleteName(this, '${name}')"><i class="fas fa-trash"></i> ডিলিট</button>
                </td>
            `;
            nameTableBody.insertBefore(row, nameTableBody.firstChild);
            saveNamesToLocalStorage();
        }

        function deleteName(button, name) {
            if (confirm('আপনি কি এই নাম ডিলিট করতে চান?')) {
                const row = button.parentElement.parentElement;
                row.remove();
                usedNames.delete(name);
                saveNamesToLocalStorage();
            }
        }

        function deleteAllNames() {
            if (confirm('আপনি কি সব নাম ডিলিট করতে চান?')) {
                const nameTableBody = document.getElementById('nameTableBody');
                nameTableBody.innerHTML = '';
                usedNames.clear();
                nameCounter = 0;
                localStorage.removeItem('generatedNames');
                alert('সব নাম ডিলিট করা হয়েছে!');
            }
        }

        function saveNamesToLocalStorage() {
            const nameTableBody = document.getElementById('nameTableBody');
            const rows = nameTableBody.getElementsByTagName('tr');
            const names = [];

            for (let row of rows) {
                const name = row.cells[0].textContent.trim();
                names.push(name);
            }

            localStorage.setItem('generatedNames', JSON.stringify(names));
        }

        function loadNamesFromLocalStorage() {
            const names = JSON.parse(localStorage.getItem('generatedNames') || '[]');
            const nameTableBody = document.getElementById('nameTableBody');
            nameTableBody.innerHTML = '';

            for (let name of names.reverse()) {
                usedNames.add(name);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${name}</td>
                    <td>
                        <button class="copy-btn" onclick="copyText('${name}')"><i class="fas fa-copy"></i> কপি</button>
                        <button class="action-btn delete-btn" onclick="deleteName(this, '${name}')"><i class="fas fa-trash"></i> ডিলিট</button>
                    </td>
                `;
                nameTableBody.appendChild(row);
            }
        }

        function copyAllNames() {
            const nameTableBody = document.getElementById('nameTableBody');
            const rows = nameTableBody.getElementsByTagName('tr');
            if (rows.length === 0) {
                alert('কোনো নাম জেনারেট করা হয়নি!');
                return;
            }

            let copyText = '';
            for (let row of rows) {
                const name = row.cells[0].textContent.trim();
                copyText += `${name}\n`;
            }

            const textarea = document.createElement('textarea');
            textarea.value = copyText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('সব নাম কপি করা হয়েছে!');
        }

        // Gmail Generator Logic
        function generateCredentials() {
            const chars = 'abcdefghijklmnopqrstuvwxyz';
            const emailLength = Math.floor(Math.random() * 3) + 10;
            let email = '';
            for (let i = 0; i < emailLength; i++) {
                email += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('generatedEmail').value = email;

            const passwordChars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const passwordLength = Math.floor(Math.random() * 2) + 8;
            let password = '';
            for (let i = 0; i < passwordLength; i++) {
                password += passwordChars.charAt(Math.floor(Math.random() * passwordChars.length));
            }
            document.getElementById('generatedPassword').value = password;

            addToTable(email, password);
        }

        function addToTable(email, password) {
            const tableBody = document.getElementById('tableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>
                    ${email}
                    <button class="copy-btn" onclick="copyText('${email}')"><i class="fas fa-copy"></i> কপি</button>
                </td>
                <td>
                    ${password}
                    <button class="copy-btn" onclick="copyText('${password}')"><i class="fas fa-copy"></i> কপি</button>
                </td>
                <td>
                    <button class="action-btn success-btn" onclick="saveCredential(this, '${email}', '${password}')">সেভ</button>
                    <button class="action-btn delete-btn" onclick="confirmDelete(this)">ডিলিট</button>
                </td>
            `;
            tableBody.insertBefore(row, tableBody.firstChild);
            saveToLocalStorage();
        }

        function copyText(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert(`${text} কপি করা হয়েছে!`);
        }

        function copyAllCredentials() {
            const tableBody = document.getElementById('tableBody');
            const rows = tableBody.getElementsByTagName('tr');
            if (rows.length === 0) {
                alert('কোনো জিমেইল বা পাসওয়ার্ড নেই!');
                return;
            }

            let copyText = '';
            let hasSavedEntries = false;
            for (let row of rows) {
                if (!row.cells[2].innerHTML.includes('success-btn')) {
                    const email = row.cells[0].childNodes[0].textContent.trim();
                    const password = row.cells[1].childNodes[0].textContent.trim();
                    copyText += `------------------------------\n`;
                    copyText += `Email: ${email}\n`;
                    copyText += `Password: ${password}\n`;
                    copyText += `------------------------------\n`;
                    hasSavedEntries = true;
                }
            }

            if (!hasSavedEntries) {
                alert('কোনো সেভ করা জিমেইল বা পাসওয়ার্ড নেই!');
                return;
            }

            const textarea = document.createElement('textarea');
            textarea.value = copyText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('সব সেভ করা জিমেইল এবং পাসওয়ার্ড কপি করা হয়েছে!');
        }

        function deleteAllCredentials() {
            if (confirm('আপনি কি সব জিমেইল এবং পাসওয়ার্ড ডিলিট করতে চান?')) {
                const tableBody = document.getElementById('tableBody');
                tableBody.innerHTML = '';
                localStorage.removeItem('credentials');
                alert('সব জিমেইল এবং পাসওয়ার্ড ডিলিট করা হয়েছে!');
            }
        }

        function createAccountFromInput() {
            const email = document.getElementById('generatedEmail').value;
            const creationUrl = email 
                ? `https://accounts.google.com/signup/v2/webcreateaccount?flowName=GlifWebSignIn&flowEntry=SignUp&email=${encodeURIComponent(email + '@gmail.com')}`
                : `https://accounts.google.com/signup/v2/webcreateaccount?flowName=GlifWebSignIn&flowEntry=SignUp`;
            window.open(creationUrl, '_blank');
        }

        function saveCredential(button, email, password) {
            const row = button.parentElement.parentElement;
            const fullEmail = email + '@gmail.com';
            const timestamp = new Date().toLocaleString('bn-BD', { dateStyle: 'short', timeStyle: 'short' });
            row.cells[0].innerHTML = `
                ${fullEmail}
                <button class="copy-btn" onclick="copyText('${fullEmail}')"><i class="fas fa-copy"></i> কপি</button>
            `;
            row.cells[1].innerHTML = `
                ${password}
                <button class="copy-btn" onclick="copyText('${password}')"><i class="fas fa-copy"></i> কপি</button>
            `;
            row.cells[2].innerHTML = `
                <span class="timestamp">সেভ করা হয়েছে: ${timestamp}</span>
                <button class="action-btn delete-btn" onclick="confirmDelete(this)">ডিলিট</button>
            `;
            saveToLocalStorage();
        }

        function confirmDelete(button) {
            if (confirm('আপনি কি এই এন্ট্রি ডিলিট করতে চান?')) {
                if (confirm('আপনি কি নিশ্চিত?')) {
                    const row = button.parentElement.parentElement;
                    row.remove();
                    saveToLocalStorage();
                }
            }
        }

        function saveToLocalStorage() {
            const tableBody = document.getElementById('tableBody');
            const rows = tableBody.getElementsByTagName('tr');
            const credentials = [];

            for (let row of rows) {
                const email = row.cells[0].childNodes[0].textContent.trim();
                const password = row.cells[1].childNodes[0].textContent.trim();
                const actionCell = row.cells[2].innerHTML;
                credentials.push({ email, password, actionCell });
            }

            localStorage.setItem('credentials', JSON.stringify(credentials));
        }

        function loadFromLocalStorage() {
            const credentials = JSON.parse(localStorage.getItem('credentials') || '[]');
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            for (let cred of credentials.reverse()) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        ${cred.email}
                        <button class="copy-btn" onclick="copyText('${cred.email}')"><i class="fas fa-copy"></i> কপি</button>
                    </td>
                    <td>
                        ${cred.password}
                        <button class="copy-btn" onclick="copyText('${cred.password}')"><i class="fas fa-copy"></i> কপি</button>
                    </td>
                    <td>
                        ${cred.actionCell}
                    </td>
                `;
                tableBody.appendChild(row);
            }
        }

        // Gmail Extractor Logic
        function extractGmails() {
            const text = document.getElementById("inputText").value;
            const regex = /\b[A-Za-z0-9._%+-]+@gmail\.com\b/g;
            const matches = text.match(regex);
            const output = document.getElementById("output");
            const countDisplay = document.getElementById("count");

            if (matches) {
                output.value = matches.join("\n");
                countDisplay.textContent = `মোট Gmail: ${matches.length} টি`;
            } else {
                output.value = "কোনো Gmail পাওয়া যায়নি।";
                countDisplay.textContent = "মোট Gmail: ০ টি";
            }
        }

        function copyGmails() {
            const output = document.getElementById("output");
            output.select();
            output.setSelectionRange(0, 99999);
            document.execCommand('copy');
            alert("Gmail গুলো কপি করা হয়েছে!");
        }

        // Gmail Duplicate Detector Logic
        let emails = [];

        function processEmails() {
            const input = document.getElementById('inputData').value.trim();
            const emailList = document.getElementById('emailList');
            const message = document.getElementById('message');
            const duplicateCount = document.getElementById('duplicateCount');
            const totalEmails = document.getElementById('totalEmails');
            emails = [];
            emailList.innerHTML = '';
            duplicateCount.textContent = '';
            totalEmails.textContent = '';

            if (input === '') {
                message.textContent = 'দয়া করে কিছু জিমেইল পেস্ট করুন!';
                return;
            }

            const lines = input.split('\n');
            const emailRegex = /([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/;
            for (let line of lines) {
                const match = line.match(emailRegex);
                if (match) {
                    emails.push(match[1]);
                }
            }

            totalEmails.textContent = `মোট জিমেইল: ${emails.length}`;

            const emailCount = {};
            emails.forEach(email => {
                emailCount[email] = (emailCount[email] || 0) + 1;
            });
            const duplicates = Object.entries(emailCount).filter(([email, count]) => count > 1);
            const totalDuplicates = duplicates.reduce((sum, [email, count]) => sum + (count - 1), 0);

            if (totalDuplicates > 0) {
                message.textContent = 'ডুপ্লিকেট জিমেইল পাওয়া গেছে!';
                duplicateCount.textContent = `মোট ডুপ্লিকেট জিমেইল: ${totalDuplicates}`;
            } else {
                message.textContent = 'কোনো ডুপ্লিকেট জিমেইল নেই।';
                duplicateCount.textContent = 'মোট ডুপ্লিকেট জিমেইল: 0';
            }

            emails.forEach((email, index) => {
                const li = document.createElement('li');
                const emailInfo = document.createElement('div');
                emailInfo.classList.add('email-info');
                emailInfo.textContent = email;

                if (emailCount[email] > 1) {
                    li.classList.add('duplicate');
                }

                if (emailCount[email] > 1 && emails.indexOf(email) === index) {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = 'মুছুন';
                    deleteBtn.classList.add('delete-btn');
                    deleteBtn.onclick = () => removeEmail(email, index, li);
                    li.appendChild(deleteBtn);
                }

                li.appendChild(emailInfo);
                emailList.appendChild(li);
            });
        }

        function removeEmail(email, index, li) {
            emails.splice(index, 1);
            li.remove();

            const emailList = document.getElementById('emailList');
            const message = document.getElementById('message');
            const duplicateCount = document.getElementById('duplicateCount');
            const totalEmails = document.getElementById('totalEmails');
            emailList.innerHTML = '';

            totalEmails.textContent = `মোট জিমেইল: ${emails.length}`;

            const emailCount = {};
            emails.forEach(email => {
                emailCount[email] = (emailCount[email] || 0) + 1;
            });
            const duplicates = Object.entries(emailCount).filter(([email, count]) => count > 1);
            const totalDuplicates = duplicates.reduce((sum, [email, count]) => sum + (count - 1), 0);

            if (totalDuplicates > 0) {
                message.textContent = 'ডুপ্লিকেট জিমেইল পাওয়া গেছে!';
                duplicateCount.textContent = `মোট ডুপ্লিকেট জিমেইল: ${totalDuplicates}`;
            } else {
                message.textContent = 'কোনো ডুপ্লিকেট জিমেইল নেই।';
                duplicateCount.textContent = 'মোট ডুপ্লিকেট জিমেইল: 0';
            }

            emails.forEach((email, i) => {
                const li = document.createElement('li');
                const emailInfo = document.createElement('div');
                emailInfo.classList.add('email-info');
                emailInfo.textContent = email;

                if (emailCount[email] > 1) {
                    li.classList.add('duplicate');
                }

                if (emailCount[email] > 1 && emails.indexOf(email) === i) {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = 'মুছুন';
                    deleteBtn.classList.add('delete-btn');
                    deleteBtn.onclick = () => removeEmail(email, i, li);
                    li.appendChild(deleteBtn);
                }

                li.appendChild(emailInfo);
                emailList.appendChild(li);
            });
        }

        function copyUniqueEmails() {
            const uniqueEmails = [...new Set(emails)].join('\n');
            navigator.clipboard.writeText(uniqueEmails).then(() => {
                const message = document.getElementById('message');
                message.textContent = 'ইউনিক জিমেইল কপি করা হয়েছে!';
                setTimeout(() => {
                    const emailCount = {};
                    emails.forEach(email => {
                        emailCount[email] = (emailCount[email] || 0) + 1;
                    });
                    const totalDuplicates = Object.values(emailCount).reduce((sum, count) => sum + (count > 1 ? count - 1 : 0), 0);
                    if (totalDuplicates > 0) {
                        message.textContent = 'ডুপ্লিকেট জিমেইল পাওয়া গেছে!';
                    } else if (emails.length > 0) {
                        message.textContent = 'কোনো ডুপ্লিকেট জিমেইল নেই।';
                    } else {
                        message.textContent = '';
                    }
                }, 2000);
            }).catch(err => {
                const message = document.getElementById('message');
                message.textContent = 'কপি করতে ব্যর্থ হয়েছে! দয়া করে আবার চেষ্টা করুন।';
                console.error('কপি ত্রুটি:', err);
            });
        }

        function copyDuplicateEmails() {
            const emailCount = {};
            emails.forEach(email => {
                emailCount[email] = (emailCount[email] || 0) + 1;
            });
            const duplicateEmails = Object.keys(emailCount).filter(email => emailCount[email] > 1).join('\n');
            if (duplicateEmails) {
                navigator.clipboard.writeText(duplicateEmails).then(() => {
                    const message = document.getElementById('message');
                    message.textContent = 'ডুপ্লিকেট জিমেইল কপি করা হয়েছে!';
                    setTimeout(() => {
                        const totalDuplicates = Object.values(emailCount).reduce((sum, count) => sum + (count > 1 ? count - 1 : 0), 0);
                        if (totalDuplicates > 0) {
                            message.textContent = 'ডুপ্লিকেট জিমেইল পাওয়া গেছে!';
                        } else if (emails.length > 0) {
                            message.textContent = 'কোনো ডুপ্লিকেট জিমেইল নেই।';
                        } else {
                            message.textContent = '';
                        }
                    }, 2000);
                }).catch(err => {
                    const message = document.getElementById('message');
                    message.textContent = 'কপি করতে ব্যর্থ হয়েছে! দয়া করে আবার চেষ্টা করুন।';
                    console.error('কপি ত্রুটি:', err);
                });
            } else {
                const message = document.getElementById('message');
                message.textContent = 'কোনো ডুপ্লিকেট জিমেইল নেই!';
                setTimeout(() => {
                    message.textContent = emails.length > 0 ? 'কোনো ডুপ্লিকেট জিমেইল নেই।' : '';
                }, 2000);
            }
        }

        // Initialize
        window.onload = function() {
            loadFromLocalStorage();
            loadNamesFromLocalStorage();
            checkSubscription();
        };
    </script>
</body>
</html>
